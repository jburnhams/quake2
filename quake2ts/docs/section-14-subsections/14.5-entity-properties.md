# Section 14.5: Entity Properties

**Priority**: P2 | **Effort**: 1 week | **Parallel**: Yes

## func_door
- **File**: `packages/game/src/entities/funcs.ts`
- **Source**: `../rerelease/g_func.cpp` SP_func_door
- [x] Add `lip` property (how much stays visible)
- [x] Add `accel` / `decel` (movement curves)
- [x] Add `dmg` (damage when blocking)
- [x] Add `health` (shootable door)
- [x] Add `sounds` (sound set 0-4)
- [x] Add `wait` (auto-close delay)
- [x] Parse spawnflags: TOGGLE, START_OPEN, CRUSHER, NOMONSTER, ANIMATED
- [x] Test: All door types work correctly

## trigger_multiple
- **File**: `packages/game/src/entities/triggers.ts`
- **Source**: `../rerelease/g_trigger.cpp` SP_trigger_multiple
- [x] Add `sounds` field (sound sets 1-4)
- [x] Add sound precaching/playback
- [x] Add `message` field (centerprint text)
- [x] Parse LATCHED spawnflag (area query)
- [x] Parse CLIP spawnflag
- [x] Test: Trigger plays sounds, shows messages

## Trace System Verification
- **File**: `packages/shared/src/bsp/collision.ts`
- **Source**: `../rerelease/qcommon/cm_trace.c`
- [x] Verify signed bbox offset handling (CM_ClipBoxToBrush)
- [x] Verify startsolid detection matches original
- [x] Compare PlaneDistance calculations against C code
- [x] Test: Edge cases (starting in solid, grazing edges)

## Lightmap Animation
- **File**: `packages/engine/src/render/bsp/renderer.ts`
- **Source**: `../rerelease/ref_gl` (renderer)
- **Status**: Implemented multi-style lightmap packing and shader accumulation.
- [x] Implement multi-style lightmap animation
- [x] Support flickering/pulsing lights (via shader accumulation of light styles)
- [x] Test: Maps with animated lights look correct (Unit tests verifying pipeline logic)

## View Kick Effects
- **File**: `packages/client/src/view-effects.ts`
- **Source**: `../rerelease/p_weapon.cpp:83-89` P_AddWeaponKick
- [x] Add kick duration timing (200ms)
- [x] Implement kick interpolation (P_CurrentKickFactor)
- [x] Add kick origin offset (weapon pushback)
- [x] Scale with quad damage
- [x] Test: Weapon kick feels impactful (Verified via unit tests in viewKick.test.ts)

## Armor System
- **File**: `packages/game/src/combat/damage.ts`
- **Source**: `../rerelease/g_combat.cpp:94-203` CheckArmor
- [x] Add power screen cell consumption + angle checking
- [x] Add power shield cell consumption
- [x] Implement armor type switching (keep better armor)
- [x] Add shard accumulation logic
- [x] Test: Power armor works correctly (Verified via unit tests in armor_system.test.ts)
