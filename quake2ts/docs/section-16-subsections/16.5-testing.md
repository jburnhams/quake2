# Section 16.5: Missing Tests

**Priority**: P1-P2 | **Effort**: 2 weeks | **Parallel**: Yes

## 1. Determinism Test Suite (P0)

**File**: Create `packages/game/tests/determinism.test.ts`

- [ ] Test: Same seed produces identical state (10 runs, 1000 frames)
- [ ] Test: Different seeds produce different states
- [ ] Test: Save/load produces identical future
- [ ] Test: Monster AI is deterministic (per monster type)
- [ ] Test: No Math.random in source (static analysis)
- **Effort**: 2 days

## 2. Weapon Tests (P1)

**File**: `packages/game/tests/weapons.test.ts`

Missing tests:
- [ ] Blaster speed = 1500
- [ ] Railgun damage: DM=100, SP=125
- [ ] Railgun kick: DM=200, SP=225
- [ ] Chaingun damage: DM=6, SP=8
- [ ] Chaingun burst: 1→2→3 shots
- [ ] Rocket damage: 100-120 random + 120 radius
- [ ] HyperBlaster damage: DM=15, SP=20
- [ ] BFG damage: DM=200, SP=500
- [ ] BFG in-flight lasers fire every 100ms
- [ ] Quad damage multiplier: 4x
- **Effort**: 2 days

## 3. Monster Behavior Tests (P1)

**File**: `packages/game/tests/monsters/*.test.ts`

- [ ] Medic resurrection works (9-frame cable)
- [ ] Berserk jump creates shockwave
- [ ] Soldier variants (6 types) all spawn
- [ ] Tank blindfire shoots around corners
- [ ] Gunner has all animations
- [ ] All monsters use deterministic RNG
- **Effort**: 3 days

## 4. Entity Spawn Tests (P2)

**File**: `packages/game/tests/entities/*.test.ts`

- [ ] func_door: all properties (lip, accel, dmg, health, sounds, wait)
- [ ] func_door_secret works
- [ ] func_timer fires periodically
- [ ] trigger_multiple: sounds, messages
- [ ] target_spawner creates entities
- [ ] target_blaster fires
- **Effort**: 2 days

## 5. Regression Tests (P1)

**File**: `packages/game/tests/regression/*.test.ts`

For each fixed bug:
- [ ] Blaster speed regression test
- [ ] Railgun values regression test
- [ ] Chaingun burst regression test
- [ ] BFG lasers regression test
- [ ] Quad damage regression test
- **Effort**: 1 day

## 6. Integration Tests (P2)

**File**: `packages/game/tests/integration/*.test.ts`

- [ ] Load base1.bsp, spawn player, run 100 frames
- [ ] Spawn each monster type, run AI for 100 frames
- [ ] Fire each weapon, verify projectile behavior
- [ ] Save/load round-trip test
- **Effort**: 2 days

## 7. Comparison Tests (P2)

Test against known original values:
- [ ] Monster HP values match
- [ ] Weapon damage values match
- [ ] Projectile speeds match
- [ ] Animation frame counts match
- **Effort**: 2 days

## Test Coverage Goals
- [ ] Determinism: 100% (critical)
- [ ] Weapons: >90%
- [ ] Monsters: >70%
- [ ] Entities: >60%
- [ ] Overall game package: >80%

## CI Integration
- [ ] Determinism tests in CI (required)
- [ ] Unit tests in CI (required)
- [ ] Integration tests in CI
- [ ] Nightly full regression suite

## Tasks
- [ ] Create determinism test suite (P0, 2 days)
- [ ] Add weapon value tests (P1, 2 days)
- [ ] Add monster behavior tests (P1, 3 days)
- [ ] Add regression tests (P1, 1 day)
- [ ] Add integration tests (P2, 2 days)
- [ ] Add comparison tests (P2, 2 days)
- [ ] Set up CI (P1, 1 day)

## Success Criteria
- [ ] Determinism test passes 100/100 runs
- [ ] All weapon values have tests
- [ ] All fixed bugs have regression tests
- [ ] Test coverage >80% on game package
- [ ] CI runs all P0/P1 tests on every PR
