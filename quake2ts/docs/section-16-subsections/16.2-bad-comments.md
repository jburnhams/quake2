# Section 16.2: Bad Comments

**Priority**: P2 | **Effort**: 1-2 days | **Parallel**: Yes

## Issues Found

### 1. Rambling Comments
**File**: `packages/game/src/physics/movement.ts:21-94`
- [x] 50+ lines of stream-of-consciousness debugging
- [x] Replace with concise doc comment
- [x] Extract WATER_FRICTION = 2.0, WATER_GRAVITY_SCALE = 0.1 constants
- [x] Document deviation from original clearly
- [x] Source: `../rerelease/g_phys.cpp:145-160` G_RunObject

### 2. Contradictory Comments & Math.random() Usage
**Files**: `parasite.ts`, `mutant.ts`, `chick.ts`, `flipper.ts`, `brain.ts`, `gekk.ts`, `shambler.ts`, `arachnid.ts`, `insane.ts`, `infantry.ts`, `rogue/stalker.ts`, `guardian.ts`, `gladiator.ts`
- [x] Delete "helper" comments that say "use deterministic" but use Math.random
- [x] Replace all `Math.random()` calls with `context.rng.frandom()` (or similar) in monster files.
- [x] Ensure determinism in monster behavior.

### 3. Uncertain Comments
**File**: `monsters/supertank.ts:313`
```typescript
self.viewheight = 64; // Guess, maybe higher?
```
- [x] Look up correct value in `../rerelease/m_supertank.cpp`
- [x] Replace with verified value + source ref
- [x] Remove "guess", "maybe", "probably" language in other files:
    - [x] `ai/movement.ts`
    - [x] `gibs.ts`
    - [x] `spawn.ts`
    - [x] `combat/weapons/rogue.ts`
    - [x] `combat/weapons/frames.ts`
    - [x] `monsters/shambler.ts`
    - [x] `monsters/medic.ts`
    - [x] `monsters/utils.ts`

**Find all**:
```bash
grep -rn "\(guess\|maybe.*?\|probably\|I think\|not sure\)" packages/ --include="*.ts" | grep "//"
```

### 4. Confused Test Comments
**File**: `shared/tests/bsp/trace.debug.test.ts:100,116,133`
```typescript
// Wait, why did it fail with 0?
// Maybe `traceBox` isn't using the updated collision.ts?
// Why is it 0?
```
- [x] Investigate actual behavior (Test verifies optimized traversal correctly)
- [x] Replace with explanation
- [x] No "wait", "why", "maybe" in committed tests

### 5. Missing Comments on Complex Code
**File**: `shared/src/bsp/collision.ts:300-348`
- [x] Add algorithm overview (Liang-Barsky clipping)
- [x] Explain d1, d2, enterfrac, leavefrac
- [x] Document epsilon usage
- [x] Add source ref: `../rerelease/qcommon/cm_trace.c:145-220`

**Find all complex code**:
```bash
# Functions >30 lines with no comments
```

### 6. Obvious Comments
```typescript
i++;  // Increment i  ← DELETE
x = 5;  // Set x to 5  ← DELETE
```
- [ ] Delete or replace with WHY not WHAT (Ongoing maintenance)

## Tasks
- [x] Fix rambling comments (focus on movement.ts)
- [x] Delete contradictory comments (covered in 16.1)
- [x] Look up all guessed values
- [x] Investigate or delete confused test comments
- [x] Add comments to complex algorithms
- [ ] Delete obvious comments

## Search Commands
```bash
# Find uncertain language
grep -rn "guess\|maybe.*?\|probably" packages/ --include="*.ts"

# Find confused tests
grep -rn "wait.*why\|why.*?" packages/tests/ --include="*.ts"

# Find TODO/FIXME
grep -rn "TODO\|FIXME\|HACK" packages/ --include="*.ts"
```

## Success Criteria
- [x] Zero "guess", "maybe", "probably" in comments (checked known files)
- [x] Zero contradictory comments
- [x] All complex algorithms (>30 lines) have explanatory comments
- [x] All ported code has source reference
- [x] Tests explain behavior, not confusion
