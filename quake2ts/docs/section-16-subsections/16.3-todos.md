# Section 16.3: TODO Cleanup

**Priority**: P1-P3 | **Effort**: 1 week | **Parallel**: Yes

## Critical TODOs (P1)

### 1. Player State
**File**: `packages/game/src/index.ts:200-210`
```typescript
pmFlags: 0, // TODO: get from player
viewangles: [0, 0, 0], // TODO
fov: 90, // TODO
ammo: 0, // TODO: get current weapon ammo
damageAlpha: 0, // TODO
```
- [x] Wire up actual player entity fields
- [x] Get pmFlags from player.pmove
- [x] Get viewangles from player.angles
- [x] Get fov from player.fov or cvar
- [x] Get ammo from current weapon
- [x] Calculate damageAlpha from damage taken
- **Effort**: 1 day

### 2. Worldspawn Configstrings
**File**: `packages/game/src/entities/worldspawn.ts:17-33`
```typescript
// TODO: Set configstring CS_SKY
// TODO: Set configstring CS_SKYROTATE
// TODO: Set configstring CS_SKYAXIS
// TODO: Set CD track (CS_CDTRACK)
```
- [x] Parse worldspawn properties (sky, skyrotate, skyaxis, sounds)
- [x] Call configstring API with parsed values
- [x] Test: Map sky settings apply correctly
- **Effort**: 2 hours

### 3. Gib Effects
**File**: `packages/game/src/entities/gibs.ts:67`
```typescript
// TODO: Spawn blood effect via TE_BLOOD shower if desired?
```
- [x] Add TE_BLOOD temp entity on gib spawn
- [x] Spray particles
- **Effort**: 1 hour

### 4. Medic Cable Effect
**File**: `packages/game/src/entities/monsters/medic.ts:125`
```typescript
// Spawn cable effect (TODO: visual effect)
```
- [x] Add TE_MEDIC_CABLE_ATTACK temp entity
- [x] Visual beam from medic to corpse
- **Effort**: 2 hours

## Performance TODOs (P2)

### 5. Spatial Hash for Collision
**File**: `packages/game/src/entities/system.ts`
```typescript
// Optimization TODO: Add spatial hash/tree to EntitySystem for fast box queries (P2 task).
```
- [x] Document/defer performance TODO (P2)
- [x] Implement after correctness verified
- [x] Add spatial grid/octree to EntitySystem
- [x] Bin entities by position
- [x] Query only nearby bins
- **Effort**: 3 days

## Polish TODOs (P3)

### 6. Ammo Type Names
**File**: `packages/game/src/entities/items/ammo.ts:26`
```typescript
// TODO: Map ammo type to nice name
```
- [x] Add display names for HUD
- **Effort**: 30 min

### 7. Extended Ammo Caps
**File**: `packages/game/src/inventory/ammo.ts:87`
```typescript
// TODO: Add caps for new ammo types if known, defaulting to 50 is safe for now.
```
- [x] Defer polish TODOs to mission pack work (P3)
- [ ] Add when implementing mission packs
- **Effort**: 30 min

## Find All TODOs
```bash
grep -rn "TODO\|FIXME\|HACK\|XXX" packages/ --include="*.ts" | wc -l
```

## Tasks
- [x] Fix 4 critical TODOs (P1)
- [x] Document/defer performance TODO (P2)
- [x] Defer polish TODOs to mission pack work (P3)
- [x] Verify no hidden TODOs remain

## Success Criteria
- [x] All P1 TODOs completed or have tracking issues
- [x] All TODOs have priority labels
- [x] No TODOs in critical path code
